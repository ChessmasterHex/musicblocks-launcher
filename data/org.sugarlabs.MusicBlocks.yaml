app-id: org.sugarlabs.MusicBlocks
branch: stable
runtime: org.freedesktop.Platform
runtime-version: '19.08'
sdk: org.freedesktop.Sdk
separate-locales: false
command: musicblocks
finish-args:
  - '--share=ipc'
  - '--socket=x11'
  - '--socket=pulseaudio'
  - '--share=network'
  - '--device=dri'
  - '--filesystem=home'
  - '--env=MUSICBLOCKS_PATH=/app/share/musicblocks'
modules:
  - name: mb-data
    buildsystem: simple
    build-commands:
      - python3 setup.py install --prefix=${FLATPAK_DEST}
      - install -d /app/share/appdata
      - mv /app/share/metadata/org.sugarlabs.MusicBlocks.appdata.xml /app/share/appdata
    sources:
      - type: git
        path: '..'
        branch: 'HEAD'

  - name: musicblocks
    buildsystem: simple
    build-commands:
      - install -Dm 755 musicblocks /app/bin/musicblocks
    sources:
      - type: script
        dest-filename: musicblocks
        commands:
          - /app/bin/MusicBlocks
